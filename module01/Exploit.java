import java.util.Random;

public class Exploit {
	private String name;
	private String severity;
	private int targetPort;
	private String cveId;
	private double successRate;
	private static int totalExploits;

	public Exploit(String name, String severity, int targetPort, String cveId, double successRate) {
		this.name = name;
		this.severity = severity;
		this.cveId = cveId;
		this.targetPort = targetPort;
		this.successRate = successRate;
		totalExploits++;
	}

	public void execute(Target target) {
		if (!target.getOpenport().contains(this.targetPort)) {
			System.out.println("[-] Port " + targetPort + " is closed. Exploit failed.");
			return;
		}
		Random rand = new Random();
		double chance = rand.nextDouble();
		if (chance <= this.successRate) {
			target.getVulns().add(this.name);
			System.out.println("[+] Exploit succeeded on port " + targetPort);
		} else
			System.out.println("[-] Exploit failed on port " + targetPort);
	}

	public String getName() {
		return name;
	}

	public int getTargetPort() {
		return targetPort;
	}

	public static int getTotalExploits() {
		return totalExploits;
	}

	@Override
	public String toString() {
		return this.name + " CVE:" + this.cveId + " Severity : " + this.severity;
	}

	public void getDescription() {
		System.out.println("======== EXPLOIT info ========");
		System.out.println("name : " + this.name);
		System.out.println("TargetPort : " + this.targetPort);
		System.out.println("severity : " + this.severity);
		System.out.println("CVE id : " + this.cveId);
		System.out.println("success Rate  :  " + this.successRate);
		System.out.println("total Exploits : " + totalExploits);
		System.out.println("==============================");
	}
}